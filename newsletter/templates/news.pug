{% extends 'base.pug' %}
{% load i18n %}
{% block title %} {{page_title}} {% endblock title %}
{% block content %}
.main-content
  h1
    span#typedTitleSource
      if subscribed
        p {% trans "Thanks for signing up !" %}
      else 
        if already_subscribed
          p {% trans "Oops!" %}
        else
          p {% trans "News" %}
    span#typedTitle

  if not subscribed
    h2 {% trans "Let's keep in touch" %}
  if already_subscribed
    br/
    
    p.details
      | {% blocktrans %} {{email}} is already subscribed. {% endblocktrans %}
      br/
      | {% trans "If you don't receive e-mails, please check your spam folder or " %}
      a.underline(href="{% url 'contact' %}") {% trans "contact me" %}

  if not subscribed
    form(action="{% url 'news' %}", method="post").grid-form.form-subscribe-newsletter
      {% csrf_token %}
      !=form
      input(type="submit", value='{% trans "Subscribe" %}')
  .sep

  ul.news
    {% for tweet in tweets %}
    <p class="text"> {{tweet.text|safe}} </p>
    <a href="{{tweet.url}}"><div class="image-fullwidth tall" data-src="{{tweet.image}}" style="background-image:url('{{tweet.image}}');"></div></a>
    <br>
    {% endfor %}
  
  // make img fullsize on hover
  script.
    document.querySelectorAll('ul.news .image-fullwidth').forEach(image => {
      im = new Image
      im.src = image.dataset.src
      im.onload = () => {
        image.onmouseover = () => {image.style.height = im.height + 'px'}
        image.onmouseout  = () => {image.style.height = '400px'}
      }
    })

{% endblock content %}